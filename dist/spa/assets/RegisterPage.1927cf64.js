import{_ as f,ao as u,a1 as g,R as d,V as p,U as r,a3 as i,f as t,W as m,ap as C,aq as y,Y as w,Z as V,X as v,$ as h}from"./index.c99f8be1.js";import{Q as o}from"./QInput.7902c6d2.js";import{Q as _}from"./QForm.9535495d.js";import{Q as b,a as x}from"./QCard.a453ff6c.js";import{Q as U}from"./QPage.9bc20ae8.js";import{u as R}from"./loginUserStore.d6c81401.js";import"./use-key-composition.6e228c43.js";import"./use-dark.40dd0812.js";const z=/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/,P=l=>z.test(l)||"Please enter a valid email address",Q=l=>!!l||"This textfield is required",q={name:"RegisterPage",data(){return{fullname:"",email:"",username:"",password:"",isPwd:!0,usernameCaption:{show:!1,showClass:!1,icon:null,msg:null},storeLogUser:R()}},methods:{emailValidate:P,requiredValidate:Q,onSubmit(){if(!this.usernameCaption.showClass){u.create({type:"negative",message:"Username is already taken"});return}const l={fullname:this.fullname,email:this.email,username:this.username,password:this.password};this.$api.post("/auth/signup",l).then(e=>{if(e&&e.data)this.storeLogUser.userid=e.data.id,this.storeLogUser.fullname=e.data.fullname,this.storeLogUser.username=e.data.username,this.storeLogUser.accessToken=e.data.accessToken,this.storeLogUser.userType=e.data.userType,u.create({color:"positive",message:"Registration successful"}),this.$router.push("/user/dashboard");else throw new Error("Invalid response from server")}).catch(e=>{console.error(e),u.create({color:"negative",message:`Registration failed: ${e.message}`})}).finally(()=>{this.onReset()})},onReset(){this.fullname=null,this.email=null,this.username=null,this.password=null,this.resetUserCaption()},resetUserCaption(){this.usernameCaption.show=!1,this.usernameCaption.showClass=!1,this.usernameCaption.icon=null,this.usernameCaption.msg=null},usernameValidate(){this.username?this.$api.get("/auth/"+this.username).then(l=>{l.data.valid?(this.usernameCaption.show=!0,this.usernameCaption.showClass=!0,this.usernameCaption.icon="check_circle_outline",this.usernameCaption.msg="This username is Available."):(this.usernameCaption.show=!0,this.usernameCaption.showClass=!1,this.usernameCaption.icon="highlight_off",this.usernameCaption.msg="This username is NOT Available.")}).catch(l=>{console.log(l)}):this.resetUserCaption()}},watch:{username(){this.usernameValidate()}}},T=i("div",{style:{"text-align":"center"}},[i("h2",null,"Register")],-1),k={class:"flex justify-center"},S={class:"flex flex-center"};function L(l,e,A,N,a,n){const c=g("text-caption");return d(),p(U,null,{default:r(()=>[T,i("div",k,[t(x,{class:"my-card bg-grey-1 q-px-md q-py-md",style:{width:"25rem"}},{default:r(()=>[i("div",S,[t(m,{name:"account_circle",color:"grey-6",size:"4rem"})]),t(b,null,{default:r(()=>[t(_,{onSubmit:C(n.onSubmit,["prevent"]),onReset:n.onReset,class:"q-gutter-md",ref:"myRegisterForm"},{default:r(()=>[i("div",null,[t(o,{modelValue:a.fullname,"onUpdate:modelValue":e[0]||(e[0]=s=>a.fullname=s),type:"text",label:"Your Fullname","lazy-rules":"",rules:[s=>s&&s.length>0||"Field is required"]},null,8,["modelValue","rules"])]),i("div",null,[t(o,{modelValue:a.email,"onUpdate:modelValue":e[1]||(e[1]=s=>a.email=s),type:"text",label:"Your Email","lazy-rules":"",rules:[n.emailValidate,n.requiredValidate]},null,8,["modelValue","rules"])]),i("div",null,[t(o,{modelValue:a.username,"onUpdate:modelValue":e[2]||(e[2]=s=>a.username=s),type:"text",label:"Your username","lazy-rules":"",rules:[s=>s&&s.length>0||"Field is required"]},null,8,["modelValue","rules"]),a.usernameCaption.show?(d(),p(c,{key:0,style:{"font-size":"0.9em"},class:y([a.usernameCaption.showClass?"text-positive":"text-negative"])},{default:r(()=>[t(m,{name:a.usernameCaption.icon,size:"1.5em"},null,8,["name"]),w(" "+V(a.usernameCaption.msg),1)]),_:1},8,["class"])):v("",!0)]),i("div",null,[t(o,{modelValue:a.password,"onUpdate:modelValue":e[4]||(e[4]=s=>a.password=s),type:a.isPwd?"password":"text",label:"Your Password","lazy-rules":"",rules:[s=>s&&s.length>=6||"Must be at least 6 characters"]},{append:r(()=>[t(m,{name:a.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[3]||(e[3]=s=>a.isPwd=!a.isPwd)},null,8,["name"])]),_:1},8,["modelValue","type","rules"])]),i("div",null,[t(h,{label:"Submit",type:"submit",color:"primary"}),t(h,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])]),_:1},8,["onSubmit","onReset"])]),_:1})]),_:1})])]),_:1})}var D=f(q,[["render",L]]);export{D as default};
